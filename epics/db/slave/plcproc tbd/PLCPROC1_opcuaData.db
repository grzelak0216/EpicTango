#########################################################
########################## 2023 #########################
#########################################################

### NOT CRITICAL


record(ao, "$(P):ao1:plcproc1") {
    field(DTYP, "Soft Channel")
    field(SCAN, "Passive")
    field(OUT, "$(P):s7:diLocalTimeIOC:plcproc1:ai PP")
    # field(FLNK, "$(P):ai1:plcproc1")
}

record(ai, "$(P):ai1:plcproc1") {
    field(DTYP, "Soft Channel")
    field(SCAN, ".1 second")
    field(INP, "$(P):s7:diLocalTimeIOC:plcproc1:ao")
    # field(FLNK, "$(P):ai1:received PP")
}

# record(ao, "$(P):ai1:plcproc1") {
#     field(DTYP, "Soft Channel")
#     field(OMSL, "closed_loop")
#     field(DOL, "$(P):s7:diLocalTimeIOC:plcproc1:ao PP")
#     # field(OUT, "$(P):ai0:received PP")
#      field(OUT, "$(P):ao0:notCritical:analog:received PP")
#     field(SCAN, "Passive")
#     # field(FLNK, "$(P):ai1:received PP")
# }

#########################################################

record(bo, "$(P):bo1:plcproc1") {
    field(DTYP, "Soft Channel")
    field(ZNAM, "False")    
    field(ONAM, "True")
    field(SCAN, "Passive")
    field(OUT, "$(P):s7:singleBitToPlc:plcproc1 PP")
    # field(FLNK, "$(P):bi1:plcproc1")
}

record(bi, "$(P):bi1:plcproc1") {
    field(DTYP, "Soft Channel")
    field(ZNAM, "False")    
    field(ONAM, "True")
    field(SCAN, ".1 second")
    field(INP, "$(P):s7:singleBitFromPlc:plcproc1")
}

# record(bo, "$(P):bi1:plcproc1") {
#     field(DTYP, "Soft Channel")
#     field(ZNAM, "False")    
#     field(ONAM, "True")
#     field(OMSL, "closed_loop")
#     field(DOL, "$(P):s7:singleBitFromPlc:plcproc1 PP")
#     # field(OUT, "$(P):bi1:received PP")
#     field(OUT, "$(P):bo0:notCritical:singlebit:received PP")
#     field(SCAN, "Passive")
#     # field(FLNK, "$(P):bi2:received PP")
# }

#########################################################

#########################################################
#########################################################
#########################################################

# SINGLE BIT - PLC PROC S7COM

record (bi, "$(P):s7:singleBitFromPlc:plcproc1")
{	
    field(DTYP, "OPCUA")
    field(INP, "@FAST ns=5;i=424")
	field(SCAN, "I/O Intr")
    field(DESC, "Single bit from PLC")
    field(ZSV, "MAJOR")
    field(ZNAM, "False")
    field(ONAM, "True")
    field(FLNK, "$(P):bi1:plcproc1")
}

record (bo, "$(P):s7:singleBitToPlc:plcproc1")
{	
    field(DTYP, "OPCUA")
	field(OUT, "@FAST ns=4;i=418")
    field(DESC, "Single bit to PLC")
    field(ZSV, "MAJOR")
    field(ZNAM, "False")
    field(ONAM, "True")
}


########################### Local time #########################

# record(ai, "$(P):s7:diLocalTime:ao"){
#     field(DTYP, "s7nodave")
#     field(DESC, "Read local time")
#     field(INP, "@PLC_COM DB2202.DBD4 int32")
#     field(SCAN, "I/O Intr")
# }

#Czas z PLC
record(ai, "$(P):s7:diLocalTime:plcproc1:ao")
{
    field(DTYP, "OPCUA")
    field(INP, "@FAST ns=5;i=419")
    field(DESC, "Read local time")
    field(SCAN, "I/O Intr")
}

#Czas z IOC
record(ao, "$(P):s7:diLocalTimeIOC:plcproc1:ai")
{
    field(DTYP, "OPCUA")
    field(OUT, "@FAST ns=4;i=413")
    field(DESC, "Read local time IOC")
    #field(SCAN, "I/O Intr")
}

#Czas z IOC odbbity przez PLC
record(ai, "$(P):s7:diLocalTimeIOC:plcproc1:ao")
{
    field(DTYP, "OPCUA")
    field(INP, "@FAST ns=5;i=418")
    field(DESC, "Read local time IOC")
    field(SCAN, "I/O Intr")
    field(FLNK, "$(P):ai1:plcproc1")

}
